<!DOCTYPE html>
<html lang="en" class="deeppurple-theme">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover, user-scalable=no">
    <meta name="description" content="">
    <title>withdrawal</title><!-- Material design icons CSS -->
    <link href="./withdrawal_files/icon" rel="stylesheet"><!-- Roboto fonts CSS -->
    <link href="./withdrawal_files/css" rel="stylesheet"><!-- Bootstrap core CSS -->
    <link href="./withdrawal_files/bootstrap.min.css" rel="stylesheet"><!-- Swiper CSS -->
    <link href="./withdrawal_files/swiper-bundle.min.css" rel="stylesheet"><!-- Custom styles for this template -->
    <link href="./withdrawal_files/style.css" rel="stylesheet">
    <link rel="stylesheet" href="./withdrawal_files/public.css">
    <link href="./withdrawal_files/layer.css" type="text/css" rel="styleSheet" id="layermcss">
    <link rel="shortcut icon" href="./login_files/logo.png">
    <style>
        .switch-type {
            padding-top: 5px;
            padding-bottom: 5px;
        }
    </style>
    <link href="./withdrawal_files/layer.css" type="text/css" rel="styleSheet" id="layermcss">
</head>

<body><a href="javascript:void(0)" class="closesidemenu"><i class="material-icons icons-raised bg-dark ">close</i></a>
    <div class="wrapper homepage"><!-- header -->
        <div class="header bg-template" style="backdrop-filter:none">
            <div class="row no-gutters">
                <div class="col-auto"><a href="javascript:history.go(-1)" class="btn btn-link text-white"><i
                            class="material-icons">chevron_left</i></a></div>
                <div class="col text-center"><button class="btn w-100 text-white">withdrawal</button></div>
                <div class="col-auto"><a href="./customer service center.html"
                        class="btn  btn-link text-white position-relative"><i
                            class="material-icons">support_agent</i></a></div>
            </div>
        </div><!-- header ends -->
        <div class="container">
            <div class="card bg-template shadow mt-4" style="height: 135px">
                <div class="card-body">
                    <div class="row">
                        <div class="col text-center">
                            <h3 class="balance-withdrawable mb-0 font-weight-normal">TRX</h3>
                            <p class="text-mute">amount that can be withdrawn</p>
                        </div>
                        <!-- <div class="col-auto"><button class="btn btn-default btn-rounded-54 shadow" onclick="window.location.href=`/index/ctrl/recharge`"><i class="material-icons">add</i></button></div>-->
                    </div>
                </div>
            </div>
        </div>
        <form id="main-form">
            <div class="container top-50">
                <div class="card shadow">
                    <div class="card-body bg-none">
                        <div class="row">
                            <dt class="col-5 text-secondary small">Account name</dt>
                            <dd class="acc-name col-7 small"></dd>
                            <dt class="col-5 text-secondary small">Mobile number</dt>
                            <dd class="acc-tel col-7 small"></dd>
                            <!----><!--<dt class="col-12 text-secondary small">--><!--    <div class="custom-control custom-radio switch-type">--><!--        <input type="radio" name="type" class="custom-control-input" id="customradio3" value="wallet" checked="">--><!--        <label class="custom-control-label" for="customradio3">--><!--            Withdrawal to PAYID--><!--        </label>--><!--    </div>--><!--</dt>--><!---->
                            <dt class="col-12 text-secondary small switch-type">
                                <div class="custom-control custom-radio"><input type="radio" name="type"
                                        class="custom-control-input" id="customradio5" value="TRX" checked=""><label
                                        class="custom-control-label" for="customradio5">Withdrawal to TRX Tron(TRC20)

                                        <!--(scale 1:1)--></label></div>
                            </dt>
                        </div>
                    </div>
                    <div id="TRX_code_div" class="form-group" style="padding: 0 10px;"><input type="tel"
                            class="form-control form-control-lg" name="TRX_code" id="TRX_code" autocomplete="off"
                            placeholder="TRX code"></div>
                </div>
            </div>
            <div class="container">
                <h6 class="subtitle">withdrawal amount</h6>
                <div class="form-group"><input type="tel" autocomplete="off" class="form-control form-control-lg"
                        name="num" id="num" placeholder="Please enter the withdrawal amount"></div>
                <div class="form-group"><input type="password" autocomplete="new-password"
                        class="form-control form-control-lg" name="paypassword"
                        placeholder="Please enter the fund password"></div><button type="button"
                    class="btn btn-lg btn-default btn-block btn-rounded shadow mt-4 submit-btn save-btn">withdrawal</button>
                <div class="text-mute small mt-3"><!--1.Alcance com sucesso a conta 3-5 minutos após a retirada<br>
2.Nenhuma taxa é exigida para saques<br>
3.Horário financeiro de trabalho: 9h-20h-->
                    <p class="text-mute small text-secondary"><b>The bank channel tripartite system is being upgraded,
                            the recovery time is subject to notification</b><br><span>*</span>1.There is no handling fee
                        for withdrawals below 1,000 TRX. 2% above 1,000<br><span>*</span>2.If you do not receive the
                        deposit and withdrawal, please consult customer service to solve the
                        problem<br><span>*</span>3.Bank recharge and withdrawal: The arrival time is subject to the
                        account opening area of ​​the user, and the general arrival time is 1-3 working
                        days.<br><span>*</span>4.Wallet deposit and withdrawal: (UTC) 8:00-22:00, within 30 minutes,
                        within 12 hours at other times.Single deposit and withdrawal limit: 10TRX-50,000TRX<br></p>
                </div><input type="hidden" id="_csrf_" name="_csrf_" value="60436ac94ba92"><input type="hidden"
                    id="whats_verify" name="whats_verify" value="0">
            </div>
        </form>
        <div class="notification shadow pt-0 pl-0 pr-0 border-0 bg-template-light">
            <div id="notification_countdown"></div>
            <div class="row pt-2 pl-3 pr-3">
                <div class="col-auto align-self-center pr-0"><i class="material-icons text-template md-36">redeem</i>
                </div>
                <div class="col small notification-content">loading...</div>
                <div class="col-auto align-self-center pl-0"><button class="btn btn-link closenotification"><i
                            class="material-icons text-template md-18 ">close</i></button></div>
            </div>
        </div>
    </div>
    <div id="modal-overlay" class="modal-overlay"></div>
    <div id="modal" class="modal">
        <div class="modal-inner">
            <div class="dasd-title">are you sure you want to transfer ? </div>
            <div class="btn-box">
                <div class="confirm-btn">OK</div>
                <div class="cancel-btn">cancel</div>
            </div>
        </div>
    </div>
    <script type="text/javascript">var app = {
            'online_popup': "",
        }</script><!-- jquery, popper and bootstrap js -->
    <script src="./withdrawal_files/jquery-3.3.1.min.js.download"></script>
    <script src="./withdrawal_files/popper.min.js.download"></script>
    <script src="./withdrawal_files/bootstrap.min.js.download"></script><!-- swiper js -->
    <script src="./withdrawal_files/swiper-bundle.min.js.download"></script><!-- cookie js -->
    <script src="./withdrawal_files/jquery.cookie.js.download"></script>
    <script src="./withdrawal_files/layer.js.download"></script>
    <script charset="utf-8" src="./withdrawal_files/jquery.progressBarTimer.js.download"></script>
    <script charset="utf-8" src="./withdrawal_files/common.js.download"></script><!-- template custom js -->
    <script src="./withdrawal_files/main.js.download"></script>
    <script charset="utf-8" src="./withdrawal_files/dialog.min.js.download"></script>
    <div class="showSub" style="top:-2200px">
        <div class="innerSub">
            <p style="font-size: 16px;text-align: center;color: #fff;padding: 5%;">withdrawal</p>
        </div>
        <div class="secSub"><img src="./withdrawal_files/sub-img.png" width="25%">
            <p style="text-align: center;font-size: 20px;margin-top:40px">$<span style="font-size: 40px;"
                    id="numSpan">0.00</span></p>
            <p style="text-align:center;color:#666">Withdrawal completed</p><button id="okBtn"
                class="btn btn-lg btn-default"
                style="display: block;margin: 50px auto;border-radius: 12px;width: 130px;">OK</button>
        </div>
    </div>
    <style>
        .showSub {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #a700ff 0%, #00189a 100%);
            position: fixed;
            z-index: 999;
            top: 0px;
            text-align: center;
        }

        .innerSub {
            width: 100%;
            height: 10%;
        }

        .secSub {
            width: 100%;
            height: 90%;
            padding-top: 30%;
            background: #fff;
        }
    </style>
    <script type="application/javascript">
        function isLoggedIn(){
            $.ajax({
                url: "../serve/is_user_logged_in.php",
                type: 'GET',
                success: function (data) {
                    data = JSON.parse(data)
                    if(!data.result){
                        window.location.replace('./login.html')
                    }
                },
            });
        }
        $(function () {
            isLoggedIn()
            setInterval(()=>{
                isLoggedIn()
            },10000)
            $.ajax({
                url: "../serve/get_user_data.php",
                type: 'GET',
                success: function (data) {
                    data = JSON.parse(data)
                    if(data && data.code == 0){
                        $(".balance-withdrawable").html("TRX"+Math.round(data.balance)+".00")   
                    }
                    else{
                        $(document).dialog({ infoText: data.message });
                    }
                },
            });
            $.ajax({
                url: "../serve/get_wallet_info.php",
                type: 'GET',
                success: function (data) {
                    data = JSON.parse(data)
                    if(data && data.code == 0){
                        $(".acc-name").html(data.data.username)
                        $(".acc-tel").html(underview(data.data.tel))
                    }
                    else{
                        setTimeout(()=>{
                            $(document).dialog({ infoText: data.info });
                        },2500)
                        $(".acc-name").html('李安旭')
                        $(".acc-tel").html('997****480')
                    }
                },
            });
            $('input[name="type"]').on('change', function () {
                if ($(this).val() == 'TRX') {
                    $('#TRX_code_div').show();
                } else $('#TRX_code_div').hide();
            })
            $("input[name=num]").focus();

            function underview(param){
                if(typeof param == "string"){
                    let start = (param.length / 2) - 1;
                    for(let i = start;i < (start + 4); i++){
                        param[i] = '*'
                    }
                    return param
                }
                return
            }

            function check() {
                if ($("input[name=num]").val() == '') {
                    $(document).dialog({ infoText: 'Please enter the withdrawal amount' });
                    return false;
                }
                if ($("input[name=paypassword]").val() == '') {
                    $(document).dialog({ infoText: 'Please enter the fund password' });
                    return false;
                }
                return true;
            }

            $("#okBtn").on('click', function () {
                window.location.href = '/index/my/index';
            });
            /*点击提交*/
            var sx = parseFloat("0");
            $(".save-btn").on('click', function () {
                if (check()) {
                    if (sx == 0) {
                        submit_deposit();
                        return;
                    }
                    layer.open({
                        content: 'are you sure you want to take it out ? Need&nbsp;&nbsp;0%&nbsp;&nbsp;handling fee'
                        , btn: ['OK', 'cancel']
                        , yes: function (index) {
                            submit_deposit();
                            layer.close(index);
                        }
                    });
                }
            });

            function submit_deposit() {
                var loading = null;
                $.ajax({
                    url: '../serve/withdraw.php',
                    data: $("#main-form").serialize(),
                    type: 'POST',
                    beforeSend: function () {
                        loading = $(document).dialog({
                            type: 'notice',
                            infoIcon: '/static_new/img/loading.gif',
                            infoText: 'loading...',
                            autoClose: 0
                        });
                    },
                    success: function (data) {
                        data = JSON.parse(data)
                        loading.close();
                        if (data.code == 0) {
                            $(document).dialog({ infoText: data.info });
                            localStorage.setItem('message',JSON.stringify({
                                message:"congratulations your withdrawal has been submitted successfully, kindly wait for confirmation",
                                success:true
                            }))
                             setTimeout(function () {
                                 window.location.href = './homepage.html';
                             }, 2000);
                            $("#numSpan").html($("#num").val())
                            $(".showSub").css("top", "0")
                        } else {
                            localStorage.setItem('message',JSON.stringify({
                                message:"your withdrawal could not be submitted, please put your correct Tron TRX address",
                                success:false
                            }))
                            if (data.code == -1) {
                                $(document).dialog({ infoText: data.info, autoClose: 3000 });
                                setTimeout(function () {
                                    window.location.href = './order record.html';
                                }, 3000);
                            } else {
                                $(document).dialog({ infoText: data.info });
                                setTimeout(function () {
                                    window.location.href = './homepage.html';
                                }, 3000);
                            }
                        }
                    }
                });
            }
        })
    </script>
</body>

</html>